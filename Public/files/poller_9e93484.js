
GDTDefine('gdt:mod/poller.js',function(require,exports,module){var comm=require('gdt:comm/comm.js');var Poller=function(polltime,pollnum){this.isPlaying=true;this.frun=true;this.curPoll=0;this.prePoll=0;this.pollTime=polltime;this.pollNum=pollnum;this.timer;this.onpause=function(){};this.oncontinue=function(){};this.pollArr={};};Poller.prototype.play=Poller.prototype.pollPlay=function(){var poller=this;this.timer=setTimeout(function(){poller.play();},this.pollTime);if(this.isPlaying){this.prePoll=this.curPoll;this.setCurrentState(this.curPoll);this.curPoll=(this.curPoll+1)%this.pollNum;}};Poller.prototype.setCurrentState=function(num){var poller=this;this.onflip(num);};Poller.prototype.setCurPoll=function(num){var cur=parseInt(num,10);if(!isNaN(cur)){this.prePoll=this.curPoll;this.curPoll=num;this.setCurrentState(num);}};Poller.prototype.setFrame=function(frame){this.prePoll=this.curPoll;frame=(frame>this.pollNum)?this.pollNum:frame;frame=(frame<0)?0:frame;this.curPoll=frame;this.setCurrentState(this.curPoll);};Poller.prototype.pause=function(cur){this.isPlaying=false;this.setCurPoll(cur);if(this.timer){clearTimeout(this.timer);}
comm.bind(this.onpause,this)();};Poller.prototype.goon=function(){this.isPlaying=true;if(this.timer){clearTimeout(this.timer);}
var poller=this;this.timer=setTimeout(function(){poller.play();},this.pollTime);comm.bind(this.oncontinue,this)();};Poller.prototype.clear=function(){this.isPlaying=false;if(this.timer){clearTimeout(this.timer);}};var Mod={};Mod.Poller=Poller;module.exports=Mod;});